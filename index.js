"use strict";!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.vuexLocalState=e()}(this,function(){var t=function(){function t(t,e){void 0===e&&(e={});var i=this;this.__listenList=[],this.ROOT_NAME="__state",this.namespace=e.namespace||"_vued",this.storage=e.storage||window.localStorage,this.key=e.key||"localState",this.__filter(this.ROOT_NAME,t);for(var o in t.modules)this.__filter(o,t.modules[o]);t.plugins=t.plugins||[],t.plugins.push(function(t){i.__listenList.forEach(function(e){return i.__watchModule(t,e)})})}return t.prototype.__watchModule=function(t,e){var i=this,o=this.ROOT_NAME;t.watch(function(t){return e.moduleName===o?t[e.key]:t[e.moduleName][e.key]},function(t){i.set(i.namespace+"-"+e.moduleName+"-"+e.key,t)},{deep:!0})},t.prototype.__filter=function(t,e){var i=e[this.key];if(i){e.state=e.state||{};for(var o in i)this.__dealModule(t,e.state,i[o],o)}},t.prototype.__dealModule=function(t,e,i,o){var n=this.get(this.namespace+"-"+t+"-"+o);"function"==typeof i?(e[o]=i(n),this.set(this.namespace+"-"+t+"-"+o,e[o])):e[o]=void 0===n?i:n,this.__listenList.push({moduleName:t,key:o,initValue:i})},t.prototype.clear=function(){var t=this;return this.__listenList.forEach(function(e){t.remove(t.namespace+"-"+e.moduleName+"-"+e.key)}),this.__listenList},t.prototype.remove=function(t){this.storage.removeItem(t)},t.prototype.set=function(t,e){return void 0===e?this.remove(t):(this.storage.setItem(t,this.serialize(e)),e)},t.prototype.get=function(t){return this.deserialize(this.storage.getItem(t))},t.prototype.serialize=function(t){return JSON.stringify(t)},t.prototype.deserialize=function(t){if("string"!=typeof t)return void 0;try{return JSON.parse(t)}catch(e){return t||void 0}},t}();return t});